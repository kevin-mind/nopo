{
  "type": "object",
  "properties": {
    "test_strategy": {
      "type": "object",
      "description": "Overall testing approach",
      "properties": {
        "unit_tests": {
          "type": "boolean",
          "description": "Are unit tests needed?"
        },
        "integration_tests": {
          "type": "boolean",
          "description": "Are integration tests needed?"
        },
        "e2e_tests": {
          "type": "boolean",
          "description": "Are e2e tests needed?"
        },
        "rationale": {
          "type": "string",
          "description": "Explanation of test strategy"
        }
      },
      "required": ["unit_tests", "integration_tests", "e2e_tests", "rationale"]
    },
    "test_cases": {
      "type": "array",
      "description": "Specific test scenarios to implement",
      "items": {
        "type": "object",
        "properties": {
          "name": { "type": "string", "description": "Test case name" },
          "type": {
            "type": "string",
            "enum": ["unit", "integration", "e2e"],
            "description": "Type of test"
          },
          "description": { "type": "string", "description": "What this test verifies" },
          "priority": {
            "type": "string",
            "enum": ["must-have", "should-have", "nice-to-have"],
            "description": "Priority of this test"
          },
          "manual": {
            "type": "boolean",
            "description": "false = [Auto] Claude writes the test during iteration; true = [Manual] requires human action (e.g., manual verification, external system testing)"
          }
        },
        "required": ["name", "type", "description", "priority", "manual"]
      }
    },
    "edge_cases": {
      "type": "array",
      "description": "Boundary conditions and unusual inputs to test",
      "items": { "type": "string" }
    },
    "regression_risks": {
      "type": "array",
      "description": "Existing functionality that could break",
      "items": {
        "type": "object",
        "properties": {
          "area": { "type": "string", "description": "What could break" },
          "test_coverage": {
            "type": "string",
            "enum": ["exists", "needs-update", "missing"],
            "description": "Current test coverage status"
          }
        },
        "required": ["area", "test_coverage"]
      }
    },
    "test_infrastructure": {
      "type": "array",
      "description": "Test setup or infrastructure needed",
      "items": { "type": "string" }
    },
    "ready": {
      "type": "boolean",
      "description": "Is this issue ready from a testability perspective?"
    },
    "questions": {
      "type": "array",
      "description": "Questions about expected behavior for testing",
      "items": { "type": "string" }
    }
  },
  "required": ["test_strategy", "test_cases", "ready"]
}
