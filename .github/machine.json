{
  "id": "claude-automation",
  "version": "1.0.0",
  "description": "Claude automation state machine for issue lifecycle management",
  "generatedAt": "2026-01-23T02:55:35.935Z",
  "config": {
    "id": "claude-automation",
    "initial": "detecting",
    "states": {
      "detecting": {
        "entry": "logDetecting",
        "always": [
          {
            "target": "done",
            "guard": "isAlreadyDone"
          },
          {
            "target": "blocked",
            "guard": "isBlocked"
          },
          {
            "target": "error",
            "guard": "isError"
          },
          {
            "target": "mergeQueueLogging",
            "guard": "triggeredByMergeQueueEntry"
          },
          {
            "target": "mergeQueueFailureLogging",
            "guard": "triggeredByMergeQueueFailure"
          },
          {
            "target": "mergedLogging",
            "guard": "triggeredByPRMerged"
          },
          {
            "target": "deployedStageLogging",
            "guard": "triggeredByDeployedStage"
          },
          {
            "target": "deployedProdLogging",
            "guard": "triggeredByDeployedProd"
          },
          {
            "target": "triaging",
            "guard": "triggeredByTriage"
          },
          {
            "target": "commenting",
            "guard": "triggeredByComment"
          },
          {
            "target": "orchestrating",
            "guard": "triggeredByOrchestrate"
          },
          {
            "target": "prReviewing",
            "guard": "triggeredByPRReview"
          },
          {
            "target": "prResponding",
            "guard": "triggeredByPRResponse"
          },
          {
            "target": "prRespondingHuman",
            "guard": "triggeredByPRHumanResponse"
          },
          {
            "target": "processingCI",
            "guard": "triggeredByCI"
          },
          {
            "target": "processingReview",
            "guard": "triggeredByReview"
          },
          {
            "target": "triaging",
            "guard": "needsTriage"
          },
          {
            "target": "initializing",
            "guard": "needsSubIssues"
          },
          {
            "target": "orchestrating",
            "guard": "hasSubIssues"
          },
          {
            "target": "reviewing",
            "guard": "isInReview"
          },
          {
            "target": "iterating"
          }
        ]
      },
      "triaging": {
        "entry": [
          "logTriaging",
          "runClaudeTriage"
        ],
        "type": "final"
      },
      "commenting": {
        "entry": [
          "logCommenting",
          "runClaudeComment"
        ],
        "type": "final"
      },
      "prReviewing": {
        "entry": [
          "logPRReviewing",
          "runClaudePRReview"
        ],
        "type": "final"
      },
      "prResponding": {
        "entry": [
          "logPRResponding",
          "runClaudePRResponse"
        ],
        "type": "final"
      },
      "prRespondingHuman": {
        "entry": [
          "logPRResponding",
          "runClaudePRHumanResponse"
        ],
        "type": "final"
      },
      "initializing": {
        "entry": [
          "setInProgress"
        ],
        "always": "orchestrating"
      },
      "orchestrating": {
        "entry": [
          "logOrchestrating"
        ],
        "always": [
          {
            "target": "orchestrationComplete",
            "guard": "allPhasesDone"
          },
          {
            "target": "orchestrationWaiting",
            "guard": "currentPhaseInReview"
          },
          {
            "target": "orchestrationRunning"
          }
        ]
      },
      "orchestrationRunning": {
        "entry": [
          "orchestrate"
        ],
        "type": "final"
      },
      "orchestrationWaiting": {
        "entry": [
          "logWaitingForReview"
        ],
        "type": "final"
      },
      "orchestrationComplete": {
        "entry": [
          "allPhasesDone"
        ],
        "type": "final"
      },
      "processingCI": {
        "always": [
          {
            "target": "transitioningToReview",
            "guard": "readyForReview"
          },
          {
            "target": "iterating",
            "guard": "ciPassed",
            "actions": [
              "clearFailures"
            ]
          },
          {
            "target": "blocked",
            "guard": "shouldBlock",
            "actions": [
              "blockIssue"
            ]
          },
          {
            "target": "iteratingFix",
            "guard": "ciFailed",
            "actions": [
              "handleCIFailure"
            ]
          },
          {
            "target": "iterating"
          }
        ]
      },
      "processingReview": {
        "always": [
          {
            "target": "orchestrating",
            "guard": "reviewApproved"
          },
          {
            "target": "iterating",
            "guard": "reviewRequestedChanges",
            "actions": [
              "convertToDraft"
            ]
          },
          {
            "target": "reviewing"
          }
        ]
      },
      "transitioningToReview": {
        "entry": [
          "transitionToReview"
        ],
        "always": "reviewing"
      },
      "iterating": {
        "entry": [
          "createBranch",
          "setWorking",
          "incrementIteration",
          "logIterating",
          "runClaude",
          "createPR"
        ],
        "on": {
          "CI_SUCCESS": [
            {
              "target": "transitioningToReview",
              "guard": "todosDone"
            },
            {
              "target": "iterating",
              "actions": [
                "clearFailures"
              ]
            }
          ],
          "CI_FAILURE": [
            {
              "target": "blocked",
              "guard": "maxFailuresReached",
              "actions": [
                "blockIssue"
              ]
            },
            {
              "target": "iteratingFix",
              "actions": [
                "handleCIFailure"
              ]
            }
          ]
        },
        "type": "final"
      },
      "iteratingFix": {
        "entry": [
          "createBranch",
          "incrementIteration",
          "runClaudeFixCI",
          "createPR"
        ],
        "on": {
          "CI_SUCCESS": [
            {
              "target": "transitioningToReview",
              "guard": "todosDone"
            },
            {
              "target": "iterating",
              "actions": [
                "clearFailures"
              ]
            }
          ],
          "CI_FAILURE": [
            {
              "target": "blocked",
              "guard": "maxFailuresReached",
              "actions": [
                "blockIssue"
              ]
            },
            {
              "target": "iteratingFix",
              "actions": [
                "handleCIFailure"
              ]
            }
          ]
        },
        "type": "final"
      },
      "reviewing": {
        "entry": [
          "logReviewing"
        ],
        "on": {
          "REVIEW_APPROVED": "orchestrating",
          "REVIEW_CHANGES_REQUESTED": {
            "target": "iterating",
            "actions": [
              "convertToDraft"
            ]
          },
          "REVIEW_COMMENTED": "reviewing"
        },
        "type": "final"
      },
      "blocked": {
        "type": "final"
      },
      "error": {
        "type": "final"
      },
      "mergeQueueLogging": {
        "entry": [
          "logMergeQueueEntry"
        ],
        "type": "final"
      },
      "mergeQueueFailureLogging": {
        "entry": [
          "logMergeQueueFailure"
        ],
        "type": "final"
      },
      "mergedLogging": {
        "entry": [
          "logMerged"
        ],
        "type": "final"
      },
      "deployedStageLogging": {
        "entry": [
          "logDeployedStage"
        ],
        "type": "final"
      },
      "deployedProdLogging": {
        "entry": [
          "logDeployedProd"
        ],
        "type": "final"
      },
      "done": {
        "entry": [
          "setDone",
          "closeIssue"
        ],
        "type": "final"
      }
    }
  }
}