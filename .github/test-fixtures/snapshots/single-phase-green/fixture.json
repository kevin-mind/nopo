{
  "name": "single-phase-green",
  "description": "Single task, CI passes first time - tests happy path with mock Claude",
  "timeout": 600,
  "poll_interval": 10,

  "mock_outputs": {
    "triage": {
      "triage": {
        "type": "enhancement",
        "priority": "medium",
        "size": "s",
        "estimate": 2,
        "topics": ["test"],
        "needs_info": false
      },
      "issue_body": "## Description\n\nAdd a timestamped line to the e2e-test.txt file.\n\n## Approach\n\nEdit the file and add a new line with timestamp.\n\n## Tasks\n\nSee sub-issues for implementation details.",
      "sub_issues": [
        {
          "type": "enhancement",
          "title": "Update e2e-test.txt",
          "description": "Add a timestamped line to the test file",
          "todos": [
            { "task": "Edit test-e2e-dump/e2e-test.txt and add a new line with current timestamp", "manual": false }
          ]
        }
      ],
      "agent_notes": ["Simple file update, no dependencies"]
    },
    "iterate": {
      "status": "completed_todo",
      "todo_completed": "Edit test-e2e-dump/e2e-test.txt and add a new line with current timestamp",
      "commits": [],
      "agent_notes": ["File updated successfully"]
    },
    "review": {
      "decision": "approve",
      "body": "LGTM! The file has been updated correctly with a timestamp.",
      "agent_notes": []
    }
  },

  "states": [
    {
      "name": "01-initial",
      "description": "Issue created, not yet triaged",
      "issue": {
        "state": "open",
        "labels": ["test"],
        "assignees": [],
        "body_contains": ["## Description"]
      },
      "project_fields": {
        "Status": "Backlog"
      }
    },
    {
      "name": "02-triaged",
      "description": "After triage completes",
      "issue": {
        "state": "open",
        "labels": ["enhancement", "triaged", "topic:test"],
        "assignees": []
      },
      "sub_issues": {
        "count": 1,
        "statuses": ["Ready"]
      },
      "project_fields": {
        "Status": "Backlog",
        "Priority": "P1",
        "Size": "S"
      }
    },
    {
      "name": "03-assigned",
      "description": "nopo-bot assigned, first sub-issue Working",
      "issue": {
        "state": "open",
        "assignees": ["nopo-bot"]
      },
      "sub_issues": {
        "count": 1,
        "statuses": ["Working"]
      },
      "project_fields": {
        "Status": "In Progress"
      }
    },
    {
      "name": "04-iteration-1",
      "description": "After first iteration - PR created",
      "issue": {
        "state": "open",
        "assignees": ["nopo-bot"]
      },
      "sub_issues": {
        "count": 1,
        "statuses": ["Working"],
        "iterations": [1]
      },
      "branch": {
        "exists": true,
        "pattern": "claude/issue/*/phase-1"
      },
      "pull_request": {
        "exists": true,
        "draft": true,
        "links_to_issue": true
      },
      "project_fields": {
        "Status": "In Progress",
        "Iteration": 1
      }
    },
    {
      "name": "05-ci-passed",
      "description": "CI passed, PR marked ready",
      "pull_request": {
        "exists": true,
        "draft": false
      },
      "project_fields": {
        "Status": "In Progress",
        "Failures": 0
      }
    },
    {
      "name": "06-reviewing",
      "description": "Review requested, waiting for approval",
      "pull_request": {
        "exists": true,
        "draft": false,
        "review_requested": true
      },
      "sub_issues": {
        "statuses": ["Review"]
      }
    },
    {
      "name": "07-approved",
      "description": "Review approved, ready to merge",
      "pull_request": {
        "exists": true,
        "approved": true
      }
    },
    {
      "name": "08-merged",
      "description": "PR merged, issue closed",
      "issue": {
        "state": "closed"
      },
      "sub_issues": {
        "count": 1,
        "all_closed": true,
        "statuses": ["Done"]
      },
      "pull_request": {
        "exists": true,
        "merged": true
      },
      "project_fields": {
        "Status": "Done"
      }
    }
  ],

  "expected": {
    "triage": {
      "labels": ["triaged", "enhancement"],
      "project_fields": {
        "Status": "Backlog"
      },
      "sub_issue_count": 1
    },
    "phases": [
      {
        "branch_pattern": "claude/issue/.*/phase-.*",
        "ci_required": true,
        "review_required": true
      }
    ],
    "completion": {
      "parent_status": "Done",
      "all_sub_issues_closed": true,
      "all_prs_merged": true
    }
  }
}
