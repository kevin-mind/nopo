You just submitted a review on PR #{{PR_NUMBER}}.

Your review state: {{REVIEW_STATE}}
Your review body: {{REVIEW_BODY}}

## Step 1: Get Your Review Comments

Fetch the comments from your review:
```
gh api /repos/{{REPOSITORY}}/pulls/{{PR_NUMBER}}/comments
```

Filter for comments from your review (review_id: {{REVIEW_ID}}).

## Step 2: Process Each Comment

For each comment you made:

### If it's a CHANGE REQUEST:
1. Make the requested change to the code
2. Commit with a clear message referencing the comment
3. Reply to the comment noting the fix

### If it's a QUESTION:
- Questions will be answered by the PR author
- No action needed now - wait for response

## Step 3: Finalize

After processing all comments, check if you made any commits:

### If you made commits (code changes):
Push the changes:
```
git push origin {{HEAD_REF}}
```
The push will automatically convert PR to draft and trigger CI.
CI-pass will mark it ready and re-request nopo-bot as reviewer when CI is green.

### If you made NO commits (only discussion/questions):
Post a comment summarizing your analysis, then re-request nopo-bot as reviewer:
```
gh pr comment {{PR_NUMBER}} --body "## Review Response Summary

<your analysis of the review comments and what action was taken or why no action was needed>

Re-requesting review to continue the loop."

gh pr edit {{PR_NUMBER}} --add-reviewer "nopo-bot"
```

IMPORTANT:
- ALWAYS post a comment with your findings - never leave the PR without feedback
- Make atomic commits for each change
- Reference the comment in each commit message
- Follow CLAUDE.md guidelines for all code changes