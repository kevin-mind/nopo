Triage issue #{{ISSUE_NUMBER}}: "{{ISSUE_TITLE}}"

{{ISSUE_BODY}}

## Task 1: Write triage-output.json

**Write this file FIRST** - the workflow reads it to apply labels and project fields.

```bash
cat > triage-output.json << 'EOF'
{
  "type": "<bug|enhancement|documentation|refactor|test|chore>",
  "priority": "<low|medium|high|critical|null>",
  "size": "<xs|s|m|l|xl>",
  "estimate": <1|2|3|5|8|13|21>,
  "topics": ["topic_1", "topic_2"],
  "needs_info": <true|false>
}
EOF
```

**Size guide:** XS (<1h), S (1-3h), M (3-8h), L (8-21h), XL (21+h)
**Estimate:** Must match size (XS=1, S=2-3, M=5-8, L=13, XL=21)
**Topics:** Check existing: `gh label list --search "topic:" --json name --jq '.[].name'`

## Task 2: Search Related Content

```bash
gh issue list --search "keywords" --state all --limit 10
```

Link related issues in a comment. Check for duplicates.

## Task 3: Update Issue Body

Improve the issue with `gh issue edit {{ISSUE_NUMBER}} --body "..."`:
- **Description**: Concise TLDR
- **Details**: Technical context, affected files, links to docs
- **Approach**: High-level implementation strategy
- **Questions**: Answer existing questions, add new ones if needed

## Task 4: Create Sub-Issues

**Every issue needs at least one sub-issue.** Sub-issues contain todos and produce PRs.

- **XS/S**: Single sub-issue with all todos
- **M/L/XL**: 2-5 sub-issues, one per phase

**Create sub-issue:**
```bash
PHASE1=$(gh issue create \
  --title "[Phase 1] Title Here" \
  --body "## Description
Brief description.

## Todo
- [ ] Specific task 1
- [ ] Specific task 2

Parent: #{{ISSUE_NUMBER}}" \
  --json number --jq '.number')
```

**Todo guidelines:**
- Specific implementation tasks only
- NO generic workflow steps (commit, PR, test, merge)

**Link to parent:**
```bash
PARENT_ID=$(gh api graphql -f query='query($owner: String!, $repo: String!, $number: Int!) {
  repository(owner: $owner, name: $repo) { issue(number: $number) { id } }
}' -f owner='{{REPO_OWNER}}' -f repo='{{REPO_NAME}}' -F number={{ISSUE_NUMBER}} --jq '.data.repository.issue.id')

SUB_ID=$(gh api graphql -f query='query($owner: String!, $repo: String!, $number: Int!) {
  repository(owner: $owner, name: $repo) { issue(number: $number) { id } }
}' -f owner='{{REPO_OWNER}}' -f repo='{{REPO_NAME}}' -F number=$PHASE1 --jq '.data.repository.issue.id')

gh api graphql -f query='mutation($parentId: ID!, $childId: ID!) {
  addSubIssue(input: {issueId: $parentId, subIssueId: $childId}) {
    issue { number } subIssue { number }
  }
}' -f parentId="$PARENT_ID" -f childId="$SUB_ID" -H "GraphQL-Features: sub_issues"
```

**Add to project with Ready status:**
```bash
PROJECT_INFO=$(gh api graphql -f query='query($org: String!, $projectNumber: Int!) {
  organization(login: $org) {
    projectV2(number: $projectNumber) {
      id
      fields(first: 20) {
        nodes {
          ... on ProjectV2SingleSelectField { id name options { id name } }
        }
      }
    }
  }
}' -f org='{{REPO_OWNER}}' -F projectNumber=1)

PROJECT_ID=$(echo "$PROJECT_INFO" | jq -r '.data.organization.projectV2.id')
STATUS_FIELD_ID=$(echo "$PROJECT_INFO" | jq -r '.data.organization.projectV2.fields.nodes[] | select(.name == "Status") | .id')
READY_OPTION_ID=$(echo "$PROJECT_INFO" | jq -r '.data.organization.projectV2.fields.nodes[] | select(.name == "Status") | .options[] | select(.name == "Ready") | .id')

ITEM_ID=$(gh api graphql -f query='mutation($projectId: ID!, $contentId: ID!) {
  addProjectV2ItemById(input: { projectId: $projectId, contentId: $contentId }) { item { id } }
}' -f projectId="$PROJECT_ID" -f contentId="$SUB_ID" --jq '.data.addProjectV2ItemById.item.id')

gh api graphql -f query='mutation($projectId: ID!, $itemId: ID!, $fieldId: ID!, $optionId: String!) {
  updateProjectV2ItemFieldValue(input: { projectId: $projectId, itemId: $itemId, fieldId: $fieldId, value: { singleSelectOptionId: $optionId } }) { projectV2Item { id } }
}' -f projectId="$PROJECT_ID" -f itemId="$ITEM_ID" -f fieldId="$STATUS_FIELD_ID" -f optionId="$READY_OPTION_ID"
```

## Task 5: Update Main Issue with State

```bash
gh issue edit {{ISSUE_NUMBER}} --body "## Description
TLDR here.

## Details
Technical context.

## Approach
Implementation strategy.

## Questions
- [x] Answered question

<!-- CLAUDE_MAIN_STATE
orchestration_iteration: 0
sub_issues: [$PHASE1]
current_sub_issue: 0
sub_issue_status: {}
complete: false
-->"
```

## Rules

- Write triage-output.json FIRST
- Do NOT add labels (workflow does this)
- Do NOT assign anyone
- Every issue needs sub-issues (even XS/S)
- Max 5 phases; if more needed, suggest splitting
- Sub-issue titles: `[Phase N] Title`
